#12 40.42 [ 94%] Linking CXX static library libcommon.a
#12 41.00 [ 94%] Built target common
#12 41.19 [ 97%] Building CXX object examples/command.wasm/CMakeFiles/libcommand.dir/emscripten.cpp.o
#12 44.19 [100%] Linking CXX executable ../../bin/libcommand.js
#12 83.85 [100%] Built target libbench
#12 84.68 [100%] Built target libstream
#12 85.32 [100%] Built target libmain
#12 91.45 [100%] Built target libcommand
#12 DONE 91.6s

#13 [builder 10/10] WORKDIR /src/whisper.cpp/build-em
#13 DONE 0.0s

#14 [export-stage 1/1] COPY --from=builder /src/whisper.cpp/build-em/bin /
#14 DONE 0.0s

#15 exporting to client directory
#15 copying files 10.87MB 0.1s done
#15 DONE 0.1s

 1 warning found (use docker --debug to expand):
 - InvalidBaseImagePlatform: Base image emscripten/emsdk:4.0.14 was pulled with platform "linux/amd64", expected "linux/arm64" for current build (line 4)
fix worker import path
libbench.js
libcommand.js
libmain.js
libstream.js
Build complete! WASM files are in ./wasm directory
phil@Philips-Mac-mini whisper-timur % cd ./wasm 
phil@Philips-Mac-mini wasm % open .
phil@Philips-Mac-mini wasm % cd ..
phil@Philips-Mac-mini whisper-timur % npm run build:lib

> @timur00kh/whisper.wasm@0.0.7 build:lib
> vite build --mode library

The CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.
vite v5.4.19 building for library...
✓ 12 modules transformed.

[vite:dts] Start generate declaration files...
computing gzip size (1)...[vite:dts] Declaration files built in 778ms.

dist/index.es.js              19.23 kB │ gzip:   4.88 kB
dist/libmain-D9-QM3iM.mjs  1,390.04 kB │ gzip: 494.81 kB
dist/index.cjs.js            13.97 kB │ gzip:   4.19 kB
dist/libmain-CWYJvMY5.js  1,366.98 kB │ gzip: 492.43 kB
dist/index.umd.js  1,381.35 kB │ gzip: 497.46 kB
✓ built in 1.45s
phil@Philips-Mac-mini whisper-timur % npm run build:demo


> @timur00kh/whisper.wasm@0.0.7 build:demo
> vite build --mode demo

The CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.
vite v5.4.19 building for demo...

(!) outDir /Users/phil/Sites/misc/whisper-web/whisper-timur/demo-dist is not inside project root and will not be emptied.
Use --emptyOutDir to override.

<script src="./coi-serviceworker.js"> in "/index.html" can't be bundled without type="module" attribute
✓ 45 modules transformed.
../demo-dist/index.html                      1.94 kB │ gzip:   0.61 kB
../demo-dist/assets/main-BcDUnT6f.css        4.05 kB │ gzip:   0.95 kB
../demo-dist/assets/main-Crf8-S6w.js       164.78 kB │ gzip:  52.85 kB
../demo-dist/assets/libmain-sYIRaHyF.js  1,366.54 kB │ gzip: 492.19 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 584ms

whisper-timur % tree -I 'node_modules|dist|demo-dist' 

.
├── build-wasm.sh
├── demo
│   ├── App.tsx
│   ├── components
│   │   ├── AudioLoader.tsx
│   │   ├── ModelLoader.tsx
│   │   ├── Transcription.tsx
│   │   └── WasmSupportCheck.tsx
│   ├── index.html
│   ├── main.tsx
│   ├── public
│   │   ├── coi-serviceworker.js
│   │   └── image.png
│   ├── styles
│   │   └── theme.css
│   └── utils
│       ├── AudioHandler.ts
│       └── theme-toggle.ts
├── Dockerfile
├── docs
│   ├── changelog
│   │   ├── feature-restart-on-timeout.md
│   │   └── README.md
│   └── To Do.md
├── LICENSE
├── package-lock.json
├── package.json
├── README.md
├── scripts
│   └── copy-wasm.js
├── src
│   ├── __tests__
│   │   ├── setup.ts
│   │   └── WhisperWasmService.test.ts
│   ├── index.ts
│   ├── utils
│   │   ├── Logger.ts
│   │   ├── sleep.ts
│   │   └── timeoutError.ts
│   └── whisper
│       ├── ModelConfig.ts
│       ├── ModelManager.ts
│       ├── parseCueLine.ts
│       ├── TranscriptionSession.ts
│       ├── types.ts
│       ├── wasm-module.d.ts
│       └── WhisperWasmService.ts
├── tsconfig.json
├── vite.config.ts
└── wasm
    ├── bench.wasm
    │   ├── bench.js
    │   ├── helpers.js
    │   └── index.html
    ├── command.wasm
    │   ├── command.js
    │   ├── helpers.js
    │   └── index.html
    ├── libbench.js
    ├── libcommand.js
    ├── libmain.js
    ├── libstream.js
    ├── stream.wasm
    │   ├── helpers.js
    │   ├── index.html
    │   └── stream.js
    └── whisper.wasm
        ├── helpers.js
        ├── index.html
        └── main.js

18 directories, 53 files
